<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to the Data Tests for Conditionals Workflow (VALID-IV) • pointblank</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to the Data Tests for Conditionals Workflow (VALID-IV)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pointblank</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.12.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Validation Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/validation_workflows.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/VALID-I.html">VALID-I: Data Quality Reporting</a></li>
    <li><a class="dropdown-item" href="../articles/VALID-II.html">VALID-II: Pipeline Data Validation</a></li>
    <li><a class="dropdown-item" href="../articles/VALID-III.html">VALID-III: Expectations in Unit Tests</a></li>
    <li><a class="dropdown-item" href="../articles/VALID-IV.html">VALID-IV: Data Tests for Conditionals</a></li>
    <li><a class="dropdown-item" href="../articles/VALID-V.html">VALID-V: Table Scan</a></li>
    <li><a class="dropdown-item" href="../articles/VALID-VI.html">VALID-VI: R Markdown Document Validation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Information Management</h6></li>
    <li><a class="dropdown-item" href="../articles/INFO-1.html">Intro to Information Management</a></li>
    <li><a class="dropdown-item" href="../articles/INFO-2.html">Advanced Information Management</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/pointblank/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Introduction to the Data Tests for Conditionals Workflow (VALID-IV)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/pointblank/blob/main/vignettes/VALID-IV.Rmd" class="external-link"><code>vignettes/VALID-IV.Rmd</code></a></small>
      <div class="d-none name"><code>VALID-IV.Rmd</code></div>
    </div>

    
    
<p><img src="images/VALID-IV.svg" width="100%"></p>
<p>The <em>VALID-IV: Data Tests for Conditionals</em> workflow is
probably not much of a workflow really. But maybe you consider
programming and control flow a sort of workflow. If that’s the case and
you are programming with data, the functions of this workflow might be
useful for that. A set of <code>test_*()</code> functions, with the same
arguments as the corresponding <code>expect_*()</code> functions of the
<a href="../articles/VALID-III.html"><strong>VALID-III</strong></a>
workflow, are used with data tables and the result of each call returns
a single logical value (<code>TRUE</code> or <code>FALSE</code>). Here’s
the complete list of functions with a phrase for what each function
tests:</p>
<ul>
<li>
<code><a href="../reference/col_vals_lt.html">test_col_vals_lt()</a></code>: Test whether column data are less
than a specified value.</li>
<li>
<code><a href="../reference/col_vals_lte.html">test_col_vals_lte()</a></code>: Test whether column data are less
than or equal to a specified value.</li>
<li>
<code><a href="../reference/col_vals_equal.html">test_col_vals_equal()</a></code>: Test whether column data are
equal to a specified value.</li>
<li>
<code><a href="../reference/col_vals_not_equal.html">test_col_vals_not_equal()</a></code>: Test whether column data are
not equal to a specified value.</li>
<li>
<code><a href="../reference/col_vals_gte.html">test_col_vals_gte()</a></code>: Test whether column data are
greater than or equal to a specified value.</li>
<li>
<code><a href="../reference/col_vals_gt.html">test_col_vals_gt()</a></code>: Test whether column data are
greater than a specified value.</li>
<li>
<code><a href="../reference/col_vals_between.html">test_col_vals_between()</a></code>: Test whether column data are
between two specified values.</li>
<li>
<code><a href="../reference/col_vals_not_between.html">test_col_vals_not_between()</a></code>: Test whether column data
are not between two specified values.</li>
<li>
<code><a href="../reference/col_vals_in_set.html">test_col_vals_in_set()</a></code>: Test whether column data are
part of a specified set of values.</li>
<li>
<code><a href="../reference/col_vals_not_in_set.html">test_col_vals_not_in_set()</a></code>: Test whether column data
are not part of a specified set of values.</li>
<li>
<code><a href="../reference/col_vals_make_set.html">test_col_vals_make_set()</a></code>: Test whether a set of values
is entirely accounted for in a column of values.</li>
<li>
<code><a href="../reference/col_vals_make_subset.html">test_col_vals_make_subset()</a></code>: Test whether a set of
values is a subset of a column of values.</li>
<li>
<code><a href="../reference/col_vals_increasing.html">test_col_vals_increasing()</a></code>: Test whether column data
increase by row.</li>
<li>
<code><a href="../reference/col_vals_decreasing.html">test_col_vals_decreasing()</a></code>: Test whether column data
decrease by row.</li>
<li>
<code><a href="../reference/col_vals_null.html">test_col_vals_null()</a></code>: Test whether column data are
<code>NULL</code>/<code>NA</code>.</li>
<li>
<code><a href="../reference/col_vals_not_null.html">test_col_vals_not_null()</a></code>: Test whether column data are
not <code>NULL</code>/<code>NA</code>.</li>
<li>
<code><a href="../reference/col_vals_regex.html">test_col_vals_regex()</a></code>: Test whether strings in column
data match a regex pattern.</li>
<li>
<code><a href="../reference/col_vals_within_spec.html">test_col_vals_within_spec()</a></code>: Test whether values in
column data fit within a specification.</li>
<li>
<code><a href="../reference/col_vals_expr.html">test_col_vals_expr()</a></code>: Test whether column data agree
with a predicate expression.</li>
<li>
<code><a href="../reference/rows_distinct.html">test_rows_distinct()</a></code>: Test whether row data are
distinct.</li>
<li>
<code><a href="../reference/rows_complete.html">test_rows_complete()</a></code>: Test whether row data are
complete.</li>
<li>
<code><a href="../reference/col_is_character.html">test_col_is_character()</a></code>: Test whether the columns
contain character/string data.</li>
<li>
<code><a href="../reference/col_is_numeric.html">test_col_is_numeric()</a></code>: Test whether the columns contain
numeric values.</li>
<li>
<code><a href="../reference/col_is_integer.html">test_col_is_integer()</a></code>: Test whether the columns contain
integer values.</li>
<li>
<code><a href="../reference/col_is_logical.html">test_col_is_logical()</a></code>: Test whether the columns contain
logical values.</li>
<li>
<code><a href="../reference/col_is_date.html">test_col_is_date()</a></code>: Test whether the columns contain R
<code>Date</code> objects.</li>
<li>
<code><a href="../reference/col_is_posix.html">test_col_is_posix()</a></code>: Test whether the columns contain
<code>POSIXct</code> dates.</li>
<li>
<code><a href="../reference/col_is_factor.html">test_col_is_factor()</a></code>: Test whether the columns contain
R <code>factor</code> objects.</li>
<li>
<code><a href="../reference/col_exists.html">test_col_exists()</a></code>: Test whether one or more columns
actually exist.</li>
<li>
<code><a href="../reference/col_schema_match.html">test_col_schema_match()</a></code>: Test whether columns in the
table (and their types) match a predefined schema.</li>
<li>
<code><a href="../reference/row_count_match.html">test_row_count_match()</a></code>: Test whether the row count
matches that of a different table.</li>
<li>
<code><a href="../reference/col_count_match.html">test_col_count_match()</a></code>: Test whether the column count
matches that of a different table.</li>
<li>
<code><a href="../reference/conjointly.html">test_conjointly()</a></code>: Test whether multiple rowwise
validations result in joint validity.</li>
<li>
<code><a href="../reference/serially.html">test_serially()</a></code>: Run several tests and a final
validation in a serial manner as a combined test.</li>
<li>
<code><a href="../reference/specially.html">test_specially()</a></code>: Perform a test based on a
user-defined function.</li>
</ul>
<div class="section level2">
<h2 id="exactly-like-the-expect_-functions-except-you-get-a-true-or-false">Exactly Like the <code>expect_*()</code> Functions Except You Get a
<code>TRUE</code> or <code>FALSE</code><a class="anchor" aria-label="anchor" href="#exactly-like-the-expect_-functions-except-you-get-a-true-or-false"></a>
</h2>
<p>The interface of each <code>test_*()</code> function is an exact
match to the <code>expect_*()</code> counterpart. If you haven’t used
either of those but have used the standard validation functions, here’s
a quick rundown.</p>
<p>The following arguments from the validation functions (e.g.,
<code><a href="../reference/col_vals_in_set.html">col_vals_in_set()</a></code> and many more) have been removed in the
corresponding <code>test_*()</code> functions:</p>
<ul>
<li><code>actions</code></li>
<li><code>step_id</code></li>
<li><code>label</code></li>
<li><code>brief</code></li>
<li><code>active</code></li>
</ul>
<p>Instead of <code>actions</code> we do get the <code>threshold</code>
argument as a simplified replacement. What’s supplied here is a single
failure threshold value. By default this is set to <code>1</code>
meaning that a single test that fails will result in an overall failure
and the return of <code>FALSE</code> (otherwise, <code>TRUE</code>).</p>
<p>The rules for threshold setting (in <code><a href="../reference/action_levels.html">action_levels()</a></code>,
<code><a href="../reference/action_levels.html">warn_on_fail()</a></code>, and <code><a href="../reference/action_levels.html">stop_on_fail()</a></code>) will be
explained in some detail here. Whole numbers beyond <code>1</code>
indicate that any failing units up to that absolute threshold value will
result in a <code>TRUE</code>. Likewise, fractional values (between
<code>0</code> and <code>1</code>) act as a proportional failure
threshold, where <code>0.25</code> means that 25% or more failing test
units results in a <code>FALSE</code>.</p>
<p>We can use the <code>preconditions</code> argument in cases where
we’d like to transform the input data before evaluation of the test. If
you would like to do things to the input table like summarize it,
perform filtering, mutate one or more columns, perform table joins,
etc., then this is a good way to go about that.</p>
</div>
<div class="section level2">
<h2 id="heres-several-examples-quick-snap">Here’s Several Examples Quick Snap<a class="anchor" aria-label="anchor" href="#heres-several-examples-quick-snap"></a>
</h2>
<p>Let’s have some examples before leaving this article. They will all
use our <code>small_table</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">small_table</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 13 × 8</span></span></span>
<span><span class="co">##    date_time           date           a b             c      d e     f    </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 2016-01-04 <span style="color: #949494;">11:00:00</span> 2016-01-04     2 1-bcd-345     3  <span style="text-decoration: underline;">3</span>423. TRUE  high </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 2016-01-04 <span style="color: #949494;">00:32:00</span> 2016-01-04     3 5-egh-163     8 <span style="text-decoration: underline;">10</span>000. TRUE  low  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 2016-01-05 <span style="color: #949494;">13:32:00</span> 2016-01-05     6 8-kdg-938     3  <span style="text-decoration: underline;">2</span>343. TRUE  high </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 2016-01-06 <span style="color: #949494;">17:23:00</span> 2016-01-06     2 5-jdo-903    <span style="color: #BB0000;">NA</span>  <span style="text-decoration: underline;">3</span>892. FALSE mid  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 2016-01-09 <span style="color: #949494;">12:36:00</span> 2016-01-09     8 3-ldm-038     7   284. TRUE  low  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 2016-01-11 <span style="color: #949494;">06:15:00</span> 2016-01-11     4 2-dhe-923     4  <span style="text-decoration: underline;">3</span>291. TRUE  mid  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 2016-01-15 <span style="color: #949494;">18:46:00</span> 2016-01-15     7 1-knw-093     3   843. TRUE  high </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 2016-01-17 <span style="color: #949494;">11:27:00</span> 2016-01-17     4 5-boe-639     2  <span style="text-decoration: underline;">1</span>036. FALSE low  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 2016-01-20 <span style="color: #949494;">04:30:00</span> 2016-01-20     3 5-bce-642     9   838. FALSE high </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 2016-01-20 <span style="color: #949494;">04:30:00</span> 2016-01-20     3 5-bce-642     9   838. FALSE high </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> 2016-01-26 <span style="color: #949494;">20:07:00</span> 2016-01-26     4 2-dmx-010     7   834. TRUE  low  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> 2016-01-28 <span style="color: #949494;">02:51:00</span> 2016-01-28     2 7-dmx-010     8   108. FALSE low  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> 2016-01-30 <span style="color: #949494;">11:23:00</span> 2016-01-30     1 3-dka-303    <span style="color: #BB0000;">NA</span>  <span style="text-decoration: underline;">2</span>230. TRUE  high</span></span></code></pre>
<p>If you’d like to test your <strong>pointblank</strong> validation
skill, guess whether each of these is <code>TRUE</code> or
<code>FALSE</code> before hovering over the line of code. <br><br></p>

<style>
.btn {
  box-sizing: border-box;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  border: 1px solid gray;
  color: black;
  cursor: pointer;
  display: -webkit-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
  align-self: center;
  font-weight: 500;
  line-height: 1.2;
  text-decoration: none;
  text-align: center;
}
.btn:hover, .btn:focus {
  color: black;
  outline: 0;
}

.true {
  -webkit-transition: box-shadow 200ms ease-in-out, color 200ms ease-in-out;
  border-color: gray;
  color: black;
  transition: box-shadow 200ms ease-in-out, color 200ms ease-in-out;
}
.true:hover {
  box-shadow: 0 0 40px 40px lightgreen inset;
  border: 1px solid green;
}
.true:hover::after {
  box-shadow: none;
  font-weight: 600;
  content: 'TRUE';
}
.true code {
  padding: 1px 4px 2px 4px;
  background: transparent;
  text-align: left;
}

.false {
  -webkit-transition: box-shadow 200ms ease-in-out, color 200ms ease-in-out;
  border-color: gray;
  color: black;
  transition: box-shadow 200ms ease-in-out, color 200ms ease-in-out;
}
.false:hover {
  box-shadow: 0 0 40px 40px #CC0000 inset;
  color: white;
  border: 1px solid #7A0000;
}
.false:hover::after {
  box-shadow: none;
  font-weight: 600;
  text-align: right;
  content: 'FALSE';
}
.false code {
  padding: 1px 4px 2px 4px;
  background: transparent;
  text-align: left;
}


</style>
<button class="btn true">
<code>small_table %&gt;%
  test_col_is_logical(vars(e))</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% 
  test_col_vals_between(
    vars(c), left = 1, right = 10
  )</code>
</button>

<br><button class="btn true">
<code>small_table %&gt;% 
  test_col_vals_between(
    vars(c), left = 0, right = vars(d),
    na_pass = TRUE, threshold = 0.5
  )</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% 
  test_col_vals_between(
    vars(c), left = 0, right = vars(d),
    na_pass = TRUE, threshold = 3
  )</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% 
  test_col_schema_match(
    col_schema(.tbl = small_table_sqlite())
  )</code>
</button>

<br><button class="btn true">
<code>small_table %&gt;%
  test_col_vals_regex(vars(b), regex = ".-[a-z]{3}.*")
</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% test_col_exists(columns = "g")</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% 
  test_col_vals_gt(
    vars(z), value = vars(a),
    preconditions = ~ . %&gt;% dplyr::mutate(z = c + e), threshold = 0.5
  )</code>
</button>

<p><br> And there you have it. A nice set of examples revealing their
truthy/falsy nature only <code>::after</code> closer inspection.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Richard Iannone, Mauricio Vargas, June Choe.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
