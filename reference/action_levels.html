<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='The action_levels() function works with the actions argument that is
present in the create_agent() function and in every validation step
function (which also has an actions argument). With it, we can provide
threshold failure values for any combination of warn, stop, or notify
failure states.
We can react to any entering of a state by supplying corresponding functions
to the fns argument. They will undergo evaluation at the time when the
matching state is entered. If provided to create_agent() then the policies
will be applied to every validation step, acting as a default for the
validation as a whole.
Calls of action_levels() could also be applied directly to any validation
step and this will act as an override if set also in create_agent(). Usage
of action_levels() is required to have any useful side effects (i.e.,
warnings, throwing errors) in the case of validation functions operating
directly on data (e.g., mtcars %&amp;gt;% col_vals_lt("mpg", 35)). There are two
helper functions that are convenient when using validation functions directly
on data (the agent-less workflow): warn_on_fail() and stop_on_fail().
These helpers either warn or stop (default failure threshold for each is set
to 1), and, they do so with informative warning or error messages. The
stop_on_fail() helper is applied by default when using validation functions
directly on data (more information on this is provided in Details).'><title>Set action levels: failure thresholds and functions to invoke — action_levels • pointblank</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Set action levels: failure thresholds and functions to invoke — action_levels"><meta property="og:description" content='The action_levels() function works with the actions argument that is
present in the create_agent() function and in every validation step
function (which also has an actions argument). With it, we can provide
threshold failure values for any combination of warn, stop, or notify
failure states.
We can react to any entering of a state by supplying corresponding functions
to the fns argument. They will undergo evaluation at the time when the
matching state is entered. If provided to create_agent() then the policies
will be applied to every validation step, acting as a default for the
validation as a whole.
Calls of action_levels() could also be applied directly to any validation
step and this will act as an override if set also in create_agent(). Usage
of action_levels() is required to have any useful side effects (i.e.,
warnings, throwing errors) in the case of validation functions operating
directly on data (e.g., mtcars %&amp;gt;% col_vals_lt("mpg", 35)). There are two
helper functions that are convenient when using validation functions directly
on data (the agent-less workflow): warn_on_fail() and stop_on_fail().
These helpers either warn or stop (default failure threshold for each is set
to 1), and, they do so with informative warning or error messages. The
stop_on_fail() helper is applied by default when using validation functions
directly on data (more information on this is provided in Details).'><meta property="og:image" content="https://rstudio.github.io/pointblank/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pointblank</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.12.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Validation Workflows</h6>
    <a class="dropdown-item" href="../articles/validation_workflows.html">Overview</a>
    <a class="dropdown-item" href="../articles/VALID-I.html">VALID-I: Data Quality Reporting</a>
    <a class="dropdown-item" href="../articles/VALID-II.html">VALID-II: Pipeline Data Validation</a>
    <a class="dropdown-item" href="../articles/VALID-III.html">VALID-III: Expectations in Unit Tests</a>
    <a class="dropdown-item" href="../articles/VALID-IV.html">VALID-IV: Data Tests for Conditionals</a>
    <a class="dropdown-item" href="../articles/VALID-V.html">VALID-V: Table Scan</a>
    <a class="dropdown-item" href="../articles/VALID-VI.html">VALID-VI: R Markdown Document Validation</a>
    <h6 class="dropdown-header" data-toc-skip>Information Management</h6>
    <a class="dropdown-item" href="../articles/INFO-1.html">Intro to Information Management</a>
    <a class="dropdown-item" href="../articles/INFO-2.html">Advanced Information Management</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rstudio/pointblank/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Set action levels: failure thresholds and functions to invoke</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/pointblank/blob/HEAD/R/action_levels.R" class="external-link"><code>R/action_levels.R</code></a></small>
      <div class="d-none name"><code>action_levels.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>action_levels()</code> function works with the <code>actions</code> argument that is
present in the <code><a href="create_agent.html">create_agent()</a></code> function and in every validation step
function (which also has an <code>actions</code> argument). With it, we can provide
threshold <em>failure</em> values for any combination of <code>warn</code>, <code>stop</code>, or <code>notify</code>
failure states.</p>
<p>We can react to any entering of a state by supplying corresponding functions
to the <code>fns</code> argument. They will undergo evaluation at the time when the
matching state is entered. If provided to <code><a href="create_agent.html">create_agent()</a></code> then the policies
will be applied to every validation step, acting as a default for the
validation as a whole.</p>
<p>Calls of <code>action_levels()</code> could also be applied directly to any validation
step and this will act as an override if set also in <code><a href="create_agent.html">create_agent()</a></code>. Usage
of <code>action_levels()</code> is required to have any useful side effects (i.e.,
warnings, throwing errors) in the case of validation functions operating
directly on data (e.g., <code>mtcars %&gt;% col_vals_lt("mpg", 35)</code>). There are two
helper functions that are convenient when using validation functions directly
on data (the <code>agent</code>-less workflow): <code>warn_on_fail()</code> and <code>stop_on_fail()</code>.
These helpers either warn or stop (default failure threshold for each is set
to <code>1</code>), and, they do so with informative warning or error messages. The
<code>stop_on_fail()</code> helper is applied by default when using validation functions
directly on data (more information on this is provided in <em>Details</em>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">action_levels</span><span class="op">(</span>warn_at <span class="op">=</span> <span class="cn">NULL</span>, stop_at <span class="op">=</span> <span class="cn">NULL</span>, notify_at <span class="op">=</span> <span class="cn">NULL</span>, fns <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">warn_on_fail</span><span class="op">(</span>warn_at <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stop_on_fail</span><span class="op">(</span>stop_at <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>warn_at</dt>
<dd><p><em>Threshold value for the 'warn' failure state</em></p>
<p><code>scalar&lt;integer|numeric&gt;(val&gt;=0)</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)</p>
<p>Either the threshold number or the threshold fraction of <em>failing</em> test
units that result in entering the <code>warn</code> failure state.</p></dd>


<dt>stop_at</dt>
<dd><p><em>Threshold value for the 'stop' failure state</em></p>
<p><code>scalar&lt;integer|numeric&gt;(val&gt;=0)</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)</p>
<p>Either the threshold number or the threshold fraction of <em>failing</em> test
units that result in entering the <code>stop</code> failure state.</p></dd>


<dt>notify_at</dt>
<dd><p><em>Threshold value for the 'notify' failure state</em></p>
<p><code>scalar&lt;integer|numeric&gt;(val&gt;=0)</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)</p>
<p>Either the threshold number or the threshold fraction of <em>failing</em> test
units that result in entering the <code>notify</code> failure state.</p></dd>


<dt>fns</dt>
<dd><p><em>Functions to execute when entering failure states</em></p>
<p><code>list</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)</p>
<p>A named list of functions that is to be paired with the appropriate failure
states. The syntax for this list involves using failure state names from
the set of <code>warn</code>, <code>stop</code>, and <code>notify</code>. The functions corresponding to the
failure states are provided as formulas (e.g.,
<code>list(warn = ~ warning("Too many failures."))</code>. A series of expressions for
each named state can be used by enclosing the set of statements with <code><a href="https://rdrr.io/r/base/Paren.html" class="external-link">{ }</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An <code>action_levels</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The output of the <code>action_levels()</code> call in <code>actions</code> will be interpreted
slightly differently if using an <em>agent</em> or using validation functions
directly on a data table. For convenience, when working directly on data, any
values supplied to <code>warn_at</code> or <code>stop_at</code> will be automatically given a stock
<code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning()</a></code> or <code><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop()</a></code> function. For example using
<code>small_table %&gt;% col_is_integer("date")</code> will provide a detailed stop message
by default, indicating the reason for the failure. If you were to supply the
<code>fns</code> for <code>stop</code> or <code>warn</code> manually then the stock functions would be
overridden. Furthermore, if <code>actions</code> is NULL in this workflow (the default),
<strong>pointblank</strong> will use a <code>stop_at</code> value of <code>1</code> (providing a detailed,
context-specific error message if there are any <em>failing</em> units). We can
absolutely suppress this automatic stopping behavior by at each validation
step by setting <code>active = FALSE</code>. In this interactive data case, there is no
stock function given for <code>notify_at</code>. The <code>notify</code> failure state is less
commonly used in this workflow as it is in the <em>agent</em>-based one.</p>
<p>When using an <em>agent</em>, we often opt to not use any functions in <code>fns</code> as the
<code>warn</code>, <code>stop</code>, and <code>notify</code> failure states will be reported on when using
<code>create_agent_report()</code> (and, usually that's sufficient). Instead, using the
<code>end_fns</code> argument is a better choice since that scheme provides useful data
on the entire interrogation, allowing for finer control on side effects and
reducing potential for duplicating any side effects.</p>
    </div>
    <div class="section level2">
    <h2 id="defining-threshold-values">Defining threshold values<a class="anchor" aria-label="anchor" href="#defining-threshold-values"></a></h2>
    


<p>Any threshold values supplied for the <code>warn_at</code>, <code>stop_at</code>, or <code>notify_at</code>
arguments correspond to the <code>warn</code>, <code>stop</code>, and <code>notify</code> failure states,
respectively. A threshold value can either relates to an absolute number of
test units or a fraction-of-total test units that are <em>failing</em>. Exceeding
the threshold means entering one or more of the <code>warn</code>, <code>stop</code>, or <code>notify</code>
failure states.</p>
<p>If a threshold value is a decimal value between <code>0</code> and <code>1</code> then it's a
proportional failure threshold (e.g., <code>0.15</code> indicates that if 15 percent of
the test units are found to be <em>failing</em>, then the designated failure state
is entered). Absolute values starting from <code>1</code> can be used instead, and this
constitutes an absolute failure threshold (e.g., <code>10</code> means that if 10 of the
test units are found to be <em>failing</em>, the failure state is entered).</p>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>
    


<p>For these examples, we will use the included <code>small_table</code> dataset.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">small_table</span></span>
<span><span class="co">#&gt; # A tibble: 13 x 8</span></span>
<span><span class="co">#&gt;    date_time           date           a b             c      d e     f    </span></span>
<span><span class="co">#&gt;    &lt;dttm&gt;              &lt;date&gt;     &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 2016-01-04 11:00:00 2016-01-04     2 1-bcd-345     3  3423. TRUE  high </span></span>
<span><span class="co">#&gt;  2 2016-01-04 00:32:00 2016-01-04     3 5-egh-163     8 10000. TRUE  low  </span></span>
<span><span class="co">#&gt;  3 2016-01-05 13:32:00 2016-01-05     6 8-kdg-938     3  2343. TRUE  high </span></span>
<span><span class="co">#&gt;  4 2016-01-06 17:23:00 2016-01-06     2 5-jdo-903    NA  3892. FALSE mid  </span></span>
<span><span class="co">#&gt;  5 2016-01-09 12:36:00 2016-01-09     8 3-ldm-038     7   284. TRUE  low  </span></span>
<span><span class="co">#&gt;  6 2016-01-11 06:15:00 2016-01-11     4 2-dhe-923     4  3291. TRUE  mid  </span></span>
<span><span class="co">#&gt;  7 2016-01-15 18:46:00 2016-01-15     7 1-knw-093     3   843. TRUE  high </span></span>
<span><span class="co">#&gt;  8 2016-01-17 11:27:00 2016-01-17     4 5-boe-639     2  1036. FALSE low  </span></span>
<span><span class="co">#&gt;  9 2016-01-20 04:30:00 2016-01-20     3 5-bce-642     9   838. FALSE high </span></span>
<span><span class="co">#&gt; 10 2016-01-20 04:30:00 2016-01-20     3 5-bce-642     9   838. FALSE high </span></span>
<span><span class="co">#&gt; 11 2016-01-26 20:07:00 2016-01-26     4 2-dmx-010     7   834. TRUE  low  </span></span>
<span><span class="co">#&gt; 12 2016-01-28 02:51:00 2016-01-28     2 7-dmx-010     8   108. FALSE low  </span></span>
<span><span class="co">#&gt; 13 2016-01-30 11:23:00 2016-01-30     1 3-dka-303    NA  2230. TRUE  high</span></span></code></pre><p></p></div>
<p>Create an <code>action_levels</code> object with fractional values for the <code>warn</code>,
<code>stop</code>, and <code>notify</code> states.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">al</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/action_levels.html">action_levels</a></span><span class="op">(</span></span>
<span>    warn_at <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    stop_at <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    notify_at <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
<p>A summary of settings for the <code>al</code> object is shown by printing it.</p>
<p>Create a pointblank agent and apply the <code>al</code> object to <code>actions</code>. Add two
validation steps and interrogate the <code>small_table</code>.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">agent_1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/create_agent.html">create_agent</a></span><span class="op">(</span></span>
<span>    tbl <span class="op">=</span> <span class="va">small_table</span>,</span>
<span>    actions <span class="op">=</span> <span class="va">al</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/col_vals_gt.html">col_vals_gt</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="va">a</span>, value <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/col_vals_lt.html">col_vals_lt</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="va">d</span>, value <span class="op">=</span> <span class="fl">20000</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/interrogate.html">interrogate</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p>The report from the agent will show that the <code>warn</code> state has been entered
for the first validation step but not the second one. We can confirm this in
the console by inspecting the <code>warn</code> component in the agent's x-list.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">x_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_agent_x_list.html">get_agent_x_list</a></span><span class="op">(</span>agent <span class="op">=</span> <span class="va">agent_1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_list</span><span class="op">$</span><span class="va">warn</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## [1]  TRUE FALSE</span></span></code></pre><p></p></div>
<p>Applying the <code>action_levels</code> object to the agent means that all validation
steps will inherit these settings but we can override this by applying
another such object to the validation step instead (this time using the
<code>warn_on_fail()</code> shorthand).</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">agent_2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/create_agent.html">create_agent</a></span><span class="op">(</span></span>
<span>    tbl <span class="op">=</span> <span class="va">small_table</span>,</span>
<span>    actions <span class="op">=</span> <span class="va">al</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/col_vals_gt.html">col_vals_gt</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="va">a</span>, value <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    actions <span class="op">=</span> <span class="fu"><a href="../reference/action_levels.html">warn_on_fail</a></span><span class="op">(</span>warn_at <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/col_vals_lt.html">col_vals_lt</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="va">d</span>, value <span class="op">=</span> <span class="fl">20000</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/interrogate.html">interrogate</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p>In this case, the first validation step has a less stringent failure
threshold for the <code>warn</code> state and it's high enough that the condition is not
entered. This can be confirmed in the console through inspection of the
x-list <code>warn</code> component.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">x_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_agent_x_list.html">get_agent_x_list</a></span><span class="op">(</span>agent <span class="op">=</span> <span class="va">agent_2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_list</span><span class="op">$</span><span class="va">warn</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## [1] FALSE FALSE</span></span></code></pre><p></p></div>
<p>In the context of using validation functions directly on data (i.e., no
involvement of an agent) we want to trigger warnings and raise errors. The
following will yield a warning if it is executed (returning the <code>small_table</code>
data).</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">small_table</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/col_vals_gt.html">col_vals_gt</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="va">a</span>, value <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    actions <span class="op">=</span> <span class="fu"><a href="../reference/action_levels.html">warn_on_fail</a></span><span class="op">(</span>warn_at <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
<div class="sourceCode"><pre><code><span><span class="co">## # A tibble: 13 × 8</span></span>
<span><span class="co">##    date_time           date           a b           c      d e    </span></span>
<span><span class="co">##    &lt;dttm&gt;              &lt;date&gt;     &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;</span></span>
<span><span class="co">##  1 2016-01-04 11:00:00 2016-01-04     2 1-bcd-…     3  3423. TRUE </span></span>
<span><span class="co">##  2 2016-01-04 00:32:00 2016-01-04     3 5-egh-…     8 10000. TRUE </span></span>
<span><span class="co">##  3 2016-01-05 13:32:00 2016-01-05     6 8-kdg-…     3  2343. TRUE </span></span>
<span><span class="co">##  4 2016-01-06 17:23:00 2016-01-06     2 5-jdo-…    NA  3892. FALSE</span></span>
<span><span class="co">##  5 2016-01-09 12:36:00 2016-01-09     8 3-ldm-…     7   284. TRUE </span></span>
<span><span class="co">##  6 2016-01-11 06:15:00 2016-01-11     4 2-dhe-…     4  3291. TRUE </span></span>
<span><span class="co">##  7 2016-01-15 18:46:00 2016-01-15     7 1-knw-…     3   843. TRUE </span></span>
<span><span class="co">##  8 2016-01-17 11:27:00 2016-01-17     4 5-boe-…     2  1036. FALSE</span></span>
<span><span class="co">##  9 2016-01-20 04:30:00 2016-01-20     3 5-bce-…     9   838. FALSE</span></span>
<span><span class="co">## 10 2016-01-20 04:30:00 2016-01-20     3 5-bce-…     9   838. FALSE</span></span>
<span><span class="co">## 11 2016-01-26 20:07:00 2016-01-26     4 2-dmx-…     7   834. TRUE </span></span>
<span><span class="co">## 12 2016-01-28 02:51:00 2016-01-28     2 7-dmx-…     8   108. FALSE</span></span>
<span><span class="co">## 13 2016-01-30 11:23:00 2016-01-30     1 3-dka-…    NA  2230. TRUE </span></span>
<span><span class="co">## # … with 1 more variable: f &lt;chr&gt;</span></span>
<span><span class="co">## Warning message:</span></span>
<span><span class="co">## Exceedance of failed test units where values in `a` should have been &gt;</span></span>
<span><span class="co">## `2`.</span></span>
<span><span class="co">## The `col_vals_gt()` validation failed beyond the absolute threshold</span></span>
<span><span class="co">## level (2).</span></span>
<span><span class="co">## * failure level (4) &gt;= failure threshold (2)</span></span></code></pre></div>



<p>With the same pipeline, not supplying anything for <code>actions</code> (it's <code>NULL</code> by
default) will have the same effect as using <code>stop_on_fail(stop_at = 1)</code>.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">small_table</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/col_vals_gt.html">col_vals_gt</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">a</span>, value <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## Error: Exceedance of failed test units where values in `a` should have</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## been &gt; `2`.</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">## The `col_vals_gt()` validation failed beyond the absolute threshold</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">## level (1).</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">## * failure level (4) &gt;= failure threshold (1)</span></span></code></pre><p></p></div>
<p>Here's the equivalent set of statements:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">small_table</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/col_vals_gt.html">col_vals_gt</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="va">a</span>, value <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    actions <span class="op">=</span> <span class="fu"><a href="../reference/action_levels.html">stop_on_fail</a></span><span class="op">(</span>stop_at <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## Error: Exceedance of failed test units where values in `a` should have</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## been &gt; `2`.</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">## The `col_vals_gt()` validation failed beyond the absolute threshold</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">## level (1).</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">## * failure level (4) &gt;= failure threshold (1)</span></span></code></pre><p></p></div>
<p>This is because the <code>stop_on_fail()</code> call is auto-injected in the default
case (when operating on data) for your convenience. Behind the scenes a
'secret agent' uses 'covert actions': all so you can type less.</p>
    </div>
    <div class="section level2">
    <h2 id="function-id">Function ID<a class="anchor" aria-label="anchor" href="#function-id"></a></h2>
    

<p>1-5</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Planning and Prep: 
<code><a href="create_agent.html">create_agent</a>()</code>,
<code><a href="create_informant.html">create_informant</a>()</code>,
<code><a href="db_tbl.html">db_tbl</a>()</code>,
<code><a href="draft_validation.html">draft_validation</a>()</code>,
<code><a href="file_tbl.html">file_tbl</a>()</code>,
<code><a href="scan_data.html">scan_data</a>()</code>,
<code><a href="tbl_get.html">tbl_get</a>()</code>,
<code><a href="tbl_source.html">tbl_source</a>()</code>,
<code><a href="tbl_store.html">tbl_store</a>()</code>,
<code><a href="validate_rmd.html">validate_rmd</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Richard Iannone, Mauricio Vargas, June Choe.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

